# HTML Validator –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üö® –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:

### 1. **–û–±—Ä–µ–∑–∞–Ω–∏–µ HTML –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
**–ü—Ä–æ–±–ª–µ–º–∞**: `validateAndCorrectHtml` –æ–±—Ä–µ–∑–∞–ª –∏—Ç–æ–≥–æ–≤—ã–π —Ñ–∞–π–ª –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è `max_tokens: 4000`
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª: 348 —Å—Ç—Ä–æ–∫
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª: 273 —Å—Ç—Ä–æ–∫–∏ (–æ–±—Ä–µ–∑–∞–Ω –Ω–∞ "–£—Å–ø–µ–π—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞—à–∏–º –ø—Ä–µ–¥–ª–æ–∂")

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –£–≤–µ–ª–∏—á–∏–ª `max_tokens` —Å 4000 –¥–æ 16000
- –î–æ–±–∞–≤–∏–ª –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ HTML (>10%)
- –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ >10%, —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π HTML

### 2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—É—Ç–µ–π –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º**
**–ü—Ä–æ–±–ª–µ–º–∞**: –í–∞–ª–∏–¥–∞—Ç–æ—Ä —Å—á–∏—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –æ—à–∏–±–∫–æ–π –∏ –ø—ã—Ç–∞–ª—Å—è –∏—Ö "–∏—Å–ø—Ä–∞–≤–∏—Ç—å"

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –£–ª—É—á—à–∏–ª –ø—Ä–æ–º–ø—Ç –¥–ª—è AI —Å —á–µ—Ç–∫–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—É—Ç–∏
- –î–æ–±–∞–≤–∏–ª –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (`/Users/`, `/home/`, `C:\`)
- –ò–∑–º–µ–Ω–∏–ª —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å –æ—à–∏–±–∫–∏ —Å 'critical' –Ω–∞ 'minor' –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞—Å—Å–µ—Ç–æ–≤
- –£–ª—É—á—à–∏–ª —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π –≤ asset manifest

## üîß –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### 1. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤**
```typescript
// –ë—ã–ª–æ:
max_tokens: 4000

// –°—Ç–∞–ª–æ:
max_tokens: 16000  // Increased from 4000 to prevent truncation
```

### 2. **–ó–∞—â–∏—Ç–∞ –æ—Ç –æ–±—Ä–µ–∑–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞:
const percentageDifference = (lengthDifference / originalLength) * 100;

if (percentageDifference > 10) {
  console.warn(`‚ö†Ô∏è WARNING: Corrected HTML is ${percentageDifference.toFixed(1)}% shorter than original`);
  console.warn(`‚ö†Ô∏è This may indicate content truncation. Using original HTML instead.`);
  
  // Return original HTML if significant truncation detected
  return {
    correctionsMade: [`Skipped correction due to potential content truncation`]
  };
}
```

### 3. **–£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è AI**
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
CRITICAL INSTRUCTIONS:
1. Fix ONLY the specific errors listed above
2. DO NOT modify or truncate any existing content
3. DO NOT change existing image paths or src attributes unless they are specifically listed as errors
4. PRESERVE ALL text content completely - do not cut off or truncate anything
5. Maintain the original design and layout exactly

WHAT TO PRESERVE:
- All existing image paths and src attributes
- All text content in full
- All styling and CSS
- All HTML structure and elements
- All footer content and links
```

### 4. **–ó–∞—â–∏—Ç–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π**
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏:
const isLocalDevPath = src.startsWith('/Users/') || src.startsWith('/home/') || src.startsWith('C:\\');

if (!assetExists && !isLocalDevPath) {
  errors.push({
    type: 'asset',
    severity: 'minor', // Changed from 'critical' to 'minor'
    message: `Referenced asset not found in manifest: ${src}`,
    suggestion: `Add asset ${src} to asset manifest or use correct path`
  });
}
```

### 5. **–£–ª—É—á—à–µ–Ω–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π**
```typescript
// –ë–æ–ª–µ–µ –≥–∏–±–∫–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π:
const assetExists = assetManifest.images && Array.isArray(assetManifest.images) && 
  assetManifest.images.some((img: any) => {
    const imgPath = img.path || img.filename || '';
    const imgFilename = img.filename || path.basename(imgPath);
    const srcBasename = path.basename(src);
    
    return imgFilename === srcBasename || 
           imgPath.includes(srcBasename) || 
           src.includes(imgFilename) ||
           imgPath.includes(src);
  });
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:

‚úÖ **–ö–æ–Ω—Ç–µ–Ω—Ç –±–æ–ª—å—à–µ –Ω–µ –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è** - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–º–µ—Ä –∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –æ–±—Ä–µ–∑–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
‚úÖ **–ü—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** - –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫
‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π** - –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –æ—à–∏–±–∫–∞–º–∏

## üìç –§–∞–π–ª —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏:
`src/agent/specialists/design-specialist/html-validator.ts`

–¢–µ–ø–µ—Ä—å `validateAndCorrectHtml` –±—É–¥–µ—Ç:
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑ –æ–±—Ä–µ–∑–∞–Ω–∏—è
- –ù–µ –∏–∑–º–µ–Ω—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö 