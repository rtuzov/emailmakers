# UNIVERSAL WORKFLOW INSTRUCTIONS
**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ –∞–≥–µ–Ω—Ç–æ–≤**

## üéØ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –ò–ù–°–¢–†–£–ú–ï–ù–¢–û–í

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û**: –í—Å–µ –∞–≥–µ–Ω—Ç—ã –î–û–õ–ñ–ù–´ —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ–π —Ç–æ—á–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

### 1. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
```
üìÅ initialize_email_folder - –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞–º–ø–∞–Ω–∏–∏
```

### 2. –°–ë–û–† –ö–û–ù–¢–ï–ö–°–¢–ê  
```
üìÖ get_current_date - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```

### 3. –°–ë–û–† –†–ï–°–£–†–°–û–í
```
üé® figma_asset_selector - –ü–æ–∏—Å–∫ –¥–∏–∑–∞–π–Ω-–∞—Å—Å–µ—Ç–æ–≤ (—Ç–µ–≥–∏ + —ç–º–æ—Ü–∏–∏)
üí∞ get_prices - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω –Ω–∞ –±–∏–ª–µ—Ç—ã
```

### 4. –°–û–ó–î–ê–ù–ò–ï –ö–û–ù–¢–ï–ù–¢–ê
```
‚úçÔ∏è content_generator - GPT-4o mini –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
```

### 5. –†–ï–ù–î–ï–†–ò–ù–ì EMAIL
```
üìß render_mjml - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ email HTML
```

### 6. üõ°Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –ö–ê–ß–ï–°–¢–í–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê
```
ü§ñ quality_controller - MANDATORY –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
```
**–ö–†–ò–¢–ò–ß–ù–û**: –≠—Ç–æ—Ç —à–∞–≥ –ù–ò–ö–û–ì–î–ê –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω!

### 7. –§–ò–ù–ê–õ–ò–ó–ê–¶–ò–Ø
```
‚òÅÔ∏è delivery_manager - –ó–∞–≥—Ä—É–∑–∫–∞ –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
```

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ê–í–ò–õ–ê

### –î–õ–Ø quality_controller:
- **–í–°–ï–ì–î–ê –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è** –ø–æ—Å–ª–µ render_mjml
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `html_content` - HTML –∏–∑ render_mjml
  - `mjml_source` - MJML –∏—Å—Ö–æ–¥–Ω–∏–∫  
  - `topic` - —Ç–µ–º–∞ –∫–∞–º–ø–∞–Ω–∏–∏
  - `assets_used` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∞—Å—Å–µ—Ç—ã
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –∫–∞—á–µ—Å—Ç–≤–∞**: 70/100
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã**: 0 –¥–æ–ø—É—Å—Ç–∏–º–æ

### –î–õ–Ø delivery_manager:
- **–ù–ò–ö–û–ì–î–ê –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è** –±–µ–∑ quality_controller
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ quality_gate_passed**: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å true
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –∫–∞—á–µ—Å—Ç–≤–µ**: < 70 –±–∞–ª–ª–æ–≤

---

## üîß –ü–ê–†–ê–ú–ï–¢–†–´ –ö–ê–ß–ï–°–¢–í–ï–ù–ù–û–ô –ü–†–û–í–ï–†–ö–ò

```typescript
quality_controller({
  html_content: string,           // HTML –∏–∑ render_mjml  
  mjml_source: string,           // MJML –∏—Å—Ö–æ–¥–Ω–∏–∫
  topic: string,                 // –¢–µ–º–∞ –∫–∞–º–ø–∞–Ω–∏–∏
  campaign_type: 'promotional' | 'informational' | 'seasonal',
  target_audience?: string,       // –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
  assets_used: {
    original_assets: string[],    // –ü—É—Ç–∏ –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º –∞—Å—Å–µ—Ç–∞–º
    processed_assets: string[],   // –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∞—Å—Å–µ—Ç—ã  
    sprite_metadata?: string      // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–ø—Ä–∞–π—Ç–æ–≤
  },
  prices?: {                     // –î–∞–Ω–Ω—ã–µ –æ —Ü–µ–Ω–∞—Ö
    origin?: string,
    destination?: string, 
    cheapest_price?: number,
    currency?: string,
    date_range?: string
  },
  content_metadata?: {           // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    word_count?: number,
    cta_count?: number,
    personalization_level?: string
  }
})
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢ quality_controller

```typescript
{
  success: boolean,
  data: {
    quality_gate_passed: boolean,    // –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô —Ñ–ª–∞–≥
    score: number,                   // 0-100 –±–∞–ª–ª–æ–≤
    grade: 'A' | 'B' | 'C' | 'D' | 'F',
    confidence: number,              // –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞
    
    dimension_scores: {
      content_quality: number,        // –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
      visual_appeal: number,          // –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
      technical_compliance: number,   // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
      emotional_resonance: number,    // –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
      brand_alignment: number         // –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –±—Ä–µ–Ω–¥—É
    },
    
    issues: Array<{
      type: 'content' | 'technical' | 'design' | 'accessibility',
      severity: 'critical' | 'major' | 'minor',
      description: string,
      location?: string,
      suggestion?: string
    }>,
    
    recommendations: string[],       // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
    next_steps: string[]            // –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
  }
}
```

---

## ‚ö†Ô∏è –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö –ö–ê–ß–ï–°–¢–í–ê

### –ï—Å–ª–∏ quality_controller –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω:
```
–ë–õ–û–ö–ò–†–û–í–ö–ê workflow ‚Üí –í–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–∫–∏:
"Mandatory quality check (quality_controller) was not executed"
```

### –ï—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞:
```
–£–°–õ–û–í–ù–ê–Ø –ë–õ–û–ö–ò–†–û–í–ö–ê ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ critical issues:
- 0 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º: –ü–†–û–î–û–õ–ñ–ï–ù–ò–ï
- ‚â•1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–±–ª–µ–º—ã: –ë–õ–û–ö–ò–†–û–í–ö–ê
```

### –ï—Å–ª–∏ quality_gate_passed = false:
```
–ü–û–õ–ù–ê–Ø –ë–õ–û–ö–ò–†–û–í–ö–ê ‚Üí –í–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–∫–∏:
"Quality gate failed: Score {score} below threshold or critical issues found"
```

---

## üéØ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –í –°–ò–°–¢–ï–ú–ù–´–ï –ü–†–û–ú–ü–¢–´

### –î–ª—è OpenAI Agent:
–î–æ–±–∞–≤–∏—Ç—å –≤ —Å–µ–∫—Ü–∏—é "TOOL EXECUTION WORKFLOW" –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–≥ quality_controller –º–µ–∂–¥—É render_mjml –∏ delivery_manager.

### –î–ª—è UltraThink Engine:
–í–∫–ª—é—á–∏—Ç—å `enableQualityControl: true` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è quality gates.

### –î–ª—è Workflow Orchestrator:
–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ stage 'quality_assurance' —Å tool 'quality_controller' –∏–º–µ–µ—Ç `required: true`.

### –î–ª—è Custom Prompts:
–õ—é–±—ã–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –≤–∫–ª—é—á–∞—Ç—å explicit mention quality_controller –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ —à–∞–≥–∞.

---

## üîÑ –¶–ò–ö–õ–´ –£–õ–£–ß–®–ï–ù–ò–Ø

–ü—Ä–∏ score < 70 –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è** –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–¥–æ 2 –ø–æ–ø—ã—Ç–æ–∫)
2. **–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**  
3. **–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

---

## üìù –õ–û–ì–ò–†–û–í–ê–ù–ò–ï –ö–ê–ß–ï–°–¢–í–ê

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–∞–∂–¥–æ–º agent/prompt:
```
üõ°Ô∏è Quality check: {status} 
üìä Score: {score}/100
üéØ Grade: {grade}  
‚ö†Ô∏è Issues: {critical_count} critical, {total_count} total
```

---

**–ü–û–ú–ù–ò–¢–ï**: quality_controller - —ç—Ç–æ –Ω–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π quality gate, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ —ç—Ç–æ—Ç —à–∞–≥!

## üì© FEEDBACK PACKAGE SCHEMA (STANDARD)
```json
{
  "from_role": "quality_specialist",
  "to_role": "design_specialist",
  "reason": "design_issue",          // content_issue | design_issue | technical_issue | qa_issue
  "severity": "major",               // critical | major | minor
  "notes": "CTA button too small on mobile",
  "issues": [
    { "type": "html", "msg": "Missing alt text on hero image", "location": "hero img" }
  ],
  "next_step_hint": "return_to_design" // orchestrator uses this to route
}
```
*–ö–∞–∂–¥—ã–π –≤–æ–∑–≤—Ä–∞—Ç –º–µ–∂–¥—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏ –æ–±—è–∑–∞–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É.*

### üîÑ LOOP CAPS
- Content Specialist: ‚â§ **2** –∫–æ–Ω—Ç–µ–Ω—Ç-—Ä–µ–≤–∏–∑–∏–π
- Design Specialist: ‚â§ **2** –¥–∏–∑–∞–π–Ω-—Ä–µ–≤–∏–∑–∏–π
- Quality Specialist: ‚â§ **2** –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫; –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ escalate `severity:critical` –∏ `next_step_hint:"hard_block"`
- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä: –≥–ª–æ–±–∞–ª—å–Ω–æ ‚â§ **3** —Ü–∏–∫–ª–æ–≤ –Ω–∞ –æ–¥–Ω—É –∫–∞–º–ø–∞–Ω–∏—é