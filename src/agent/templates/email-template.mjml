<mjml>
  <mj-head>
    <mj-title>{{subject}}</mj-title>
    <mj-preview>{{preheader}}</mj-preview>
    
    <!-- Русские шрифты с fallback -->
    <mj-font name="PT Sans" href="https://fonts.googleapis.com/css2?family=PT+Sans:wght@400;700&display=swap" />
    
    <mj-attributes>
      <!-- Базовые стили для всех компонентов -->
      <mj-all 
        font-family="PT Sans, Arial, Helvetica, sans-serif" 
        font-size="16px" 
        line-height="1.6" 
        color="#333333" />
      
      <!-- Стили для текста -->
      <mj-text 
        font-size="16px" 
        line-height="24px" 
        color="#333333" />
      
      <!-- Стили для заголовков -->
      <mj-section 
        background-color="#ffffff" 
        padding="20px" />
      
      <!-- Стили для кнопок -->
      <mj-button 
        background-color="#0066cc" 
        color="#ffffff" 
        font-size="16px" 
        font-weight="bold" 
        border-radius="4px" 
        padding="12px 24px" />
      
      <!-- Стили для изображений -->
      <mj-image 
        border="0" 
        display="block" 
        outline="none" 
        text-decoration="none" 
        height="auto" 
        width="100%" />
    </mj-attributes>
    
    <!-- CSS для email клиентов и темной темы -->
    <mj-style>
      /* Общие стили для email */
      .email-wrapper {
        background-color: #f4f4f4;
      }
      
      /* Outlook-specific fixes */
      .outlook-fix {
        mso-table-lspace: 0pt;
        mso-table-rspace: 0pt;
        border-collapse: collapse;
      }
      
      /* Мобильные стили */
      @media only screen and (max-width: 600px) {
        .mobile-full-width {
          width: 100% !important;
          max-width: 100% !important;
        }
        
        .mobile-center {
          text-align: center !important;
        }
        
        .mobile-padding {
          padding: 10px !important;
        }
        
        .mobile-font-size {
          font-size: 14px !important;
          line-height: 20px !important;
        }
      }
      
      /* Темная тема */
      @media (prefers-color-scheme: dark) {
        .dark-mode-bg {
          background-color: #1a1a1a !important;
        }
        
        .dark-mode-text {
          color: #ffffff !important;
        }
        
        .dark-mode-card {
          background-color: #2d2d2d !important;
        }
      }
      
      /* Убираем blue links в некоторых клиентах */
      a[x-apple-data-detectors] {
        color: inherit !important;
        text-decoration: none !important;
        font-size: inherit !important;
        font-family: inherit !important;
        font-weight: inherit !important;
        line-height: inherit !important;
      }
      
      /* Gmail fixes */
      .gmail-fix {
        display: table;
        width: 100%;
      }
      
      /* Цены */
      .price {
        font-size: 18px;
        font-weight: bold;
        color: #0066cc;
      }
      
      .currency {
        font-size: 14px;
        color: #666666;
      }
    </mj-style>
    
    <!-- Инлайн CSS для критических стилей -->
    <mj-style inline="inline">
      .header-logo {
        max-width: 200px;
        height: auto;
      }
      
      .price-highlight {
        background-color: #e6f3ff;
        padding: 8px 12px;
        border-radius: 4px;
        display: inline-block;
      }
    </mj-style>
  </mj-head>
  
  <mj-body background-color="#f4f4f4" css-class="email-wrapper">
    <!-- Header секция -->
    <mj-section background-color="#ffffff" padding="20px 0">
      <mj-column>
        <mj-image 
          src="https://kupibilet.ru/static/img/logo.svg" 
          alt="Kupibilet - дешевые авиабилеты" 
          width="200px"
          css-class="header-logo"
          href="https://kupibilet.ru"
          title="Kupibilet" />
      </mj-column>
    </mj-section>
    
    <!-- Hero секция с основным контентом -->
    <mj-section background-color="#ffffff" padding="40px 20px">
      <mj-column>
        <!-- Основной заголовок -->
        <mj-text 
          font-size="28px" 
          font-weight="bold" 
          color="#333333" 
          align="center"
          line-height="34px"
          css-class="dark-mode-text">
          {{subject}}
        </mj-text>
        
        <!-- Подзаголовок -->
        <mj-text 
          font-size="18px" 
          color="#666666" 
          align="center"
          padding-top="10px"
          css-class="dark-mode-text">
          {{preheader}}
        </mj-text>
        
        <!-- Изображение направления (если есть) -->
        {{#if hero_image}}
        <mj-image 
          src="{{hero_image}}" 
          alt="{{destination_name}}" 
          width="100%"
          padding="20px 0"
          border-radius="8px" />
        {{/if}}
        
        <!-- Основной текст -->
        <mj-text 
          font-size="16px" 
          line-height="24px" 
          color="#333333"
          padding-top="20px"
          css-class="dark-mode-text">
          {{body}}
        </mj-text>
      </mj-column>
    </mj-section>
    
    <!-- Секция с ценами -->
    {{#if prices}}
    <mj-section background-color="#f8f9fa" padding="30px 20px">
      <mj-column>
        <mj-text 
          font-size="22px" 
          font-weight="bold" 
          color="#333333" 
          align="center"
          padding-bottom="20px"
          css-class="dark-mode-text">
          Лучшие предложения
        </mj-text>
        
        {{#each prices}}
        <mj-table>
          <tr>
            <td style="padding: 15px; border: 1px solid #e0e0e0; border-radius: 6px; margin-bottom: 10px; background-color: #ffffff;">
              <table width="100%" cellpadding="0" cellspacing="0" border="0" class="outlook-fix">
                <tr>
                  <td style="width: 60%; vertical-align: top;">
                    <div style="font-size: 16px; font-weight: bold; color: #333333; margin-bottom: 4px;">
                      {{origin}} → {{destination}}
                    </div>
                    <div style="font-size: 14px; color: #666666;">
                      {{date}}
                    </div>
                  </td>
                  <td style="width: 40%; text-align: right; vertical-align: top;">
                    <div class="price-highlight">
                      <span class="price">{{price}}</span>
                      <span class="currency">{{currency}}</span>
                    </div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </mj-table>
        {{/each}}
      </mj-column>
    </mj-section>
    {{/if}}
    
    <!-- Call-to-Action секция -->
    <mj-section background-color="#ffffff" padding="40px 20px">
      <mj-column>
        <mj-button 
          href="{{cta_url}}" 
          background-color="#0066cc"
          color="#ffffff"
          font-size="18px"
          font-weight="bold"
          border-radius="6px"
          padding="16px 32px"
          width="250px">
          {{cta_text}}
        </mj-button>
        
        <!-- Дополнительная информация -->
        <mj-text 
          font-size="14px" 
          color="#999999" 
          align="center"
          padding-top="20px">
          * Цены указаны с учетом всех сборов и могут изменяться
        </mj-text>
      </mj-column>
    </mj-section>
    
    <!-- Социальные сети -->
    <mj-section background-color="#f4f4f4" padding="30px 20px">
      <mj-column>
        <mj-text 
          font-size="16px" 
          color="#333333" 
          align="center"
          padding-bottom="15px"
          css-class="dark-mode-text">
          Следите за нами в социальных сетях
        </mj-text>
        
        <mj-social 
          font-size="15px" 
          icon-size="30px" 
          mode="horizontal"
          padding="10px 25px"
          align="center">
          <mj-social-element 
            name="vkontakte" 
            href="https://vk.com/kupibilet"
            background-color="#4c75a3"
            src="https://www.mailjet.com/images/theme/v1/icons/ico-social/vk.png">
          </mj-social-element>
          <mj-social-element 
            name="telegram" 
            href="https://t.me/kupibilet"
            background-color="#0088cc"
            src="https://www.mailjet.com/images/theme/v1/icons/ico-social/telegram.png">
          </mj-social-element>
          <mj-social-element 
            name="instagram" 
            href="https://instagram.com/kupibilet"
            background-color="#3f729b"
            src="https://www.mailjet.com/images/theme/v1/icons/ico-social/instagram.png">
          </mj-social-element>
        </mj-social>
      </mj-column>
    </mj-section>
    
    <!-- Footer -->
    <mj-section background-color="#333333" padding="30px 20px">
      <mj-column>
        <!-- Логотип в футере -->
        <mj-image 
          src="https://kupibilet.ru/static/img/logo-white.svg" 
          alt="Kupibilet" 
          width="150px"
          padding-bottom="20px" />
        
        <!-- Контактная информация -->
        <mj-text 
          font-size="14px" 
          color="#cccccc" 
          align="center"
          line-height="20px">
          ООО "Купибилет"<br/>
          Россия, 125009, г. Москва, ул. Тверская, д. 7<br/>
          Телефон: +7 (495) 260-24-50<br/>
          Email: support@kupibilet.ru
        </mj-text>
        
        <!-- Ссылка отписки -->
        <mj-text 
          font-size="12px" 
          color="#999999" 
          align="center"
          padding-top="20px">
          Если вы не хотите получать наши письма, 
          <a href="{{unsubscribe_url}}" style="color: #999999; text-decoration: underline;">отпишитесь здесь</a>
        </mj-text>
        
        <!-- Конфиденциальность -->
        <mj-text 
          font-size="12px" 
          color="#999999" 
          align="center"
          padding-top="10px">
          <a href="https://kupibilet.ru/privacy" style="color: #999999; text-decoration: underline;">Политика конфиденциальности</a> | 
          <a href="https://kupibilet.ru/terms" style="color: #999999; text-decoration: underline;">Пользовательское соглашение</a>
        </mj-text>
      </mj-column>
    </mj-section>
  </mj-body>
</mjml>